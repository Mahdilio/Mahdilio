<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LIo – سرویس VPN حرفه‌ای و رایگان</title>

  <!-- Tailwind CSS + Font & Icons -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>

  <!-- Tailwind Config & Custom Styles -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            vazir: ['Vazirmatn','Tahoma','Arial','sans-serif']
          },
          colors: {
            brand: {
              50:  '#ecfeff',100:'#cffafe',200:'#a5f3fc',300:'#67e8f9',
              400:'#22d3ee',500:'#06b6d4',600:'#0891b2',700:'#0e7490',
              800:'#155e75',900:'#164e63'
            }
          },
          animation: {
            'gradient-bg':'gradient-bg 16s ease infinite',
            'fade-in':'fadeIn 0.6s ease-out both',
            'slide-up':'slideUp 0.7s ease-out both',
            'pulse-fast':'pulse 2s linear infinite',
            'float':'float 6s ease-in-out infinite'
          },
          keyframes: {
            gradient-bg: {
              '0%,100%':{ 'background-position':'0% 50%' },
              '50%':{ 'background-position':'100% 50%' }
            },
            fadeIn:{ '0%':{opacity:0},'100%':{opacity:1} },
            slideUp:{ '0%':{transform:'translateY(20px)',opacity:0}, '100%':{transform:'translateY(0)',opacity:1} },
            float:{ '0%,100%':{transform:'translateY(0)'}, '50%':{transform:'translateY(-6px)'} }
          }
        }
      }
    }
  </script>

  <style>
    body {
      font-family: 'Vazirmatn', sans-serif;
      background: linear-gradient(-45deg,#0b1220,#0f172a,#111827,#1f1148);
      background-size:400% 400%;
      animation:gradient-bg 16s ease infinite;
      color:#e5e7eb;
      scroll-behavior:smooth;
    }
    .card-glass {
      background:rgba(255,255,255,0.06);
      backdrop-filter:blur(16px);
      border:1px solid rgba(255,255,255,0.12);
      box-shadow:0 10px 40px rgba(0,0,0,0.25);
      transition:transform .3s ease,background .3s, border-color .3s;
    }
    .card-glass:hover {
      transform:translateY(-6px);
      background:rgba(255,255,255,0.1);
      border-color:rgba(255,255,255,0.22);
    }
    .ripple { position:relative; overflow:hidden; }
    .ripple::before {
      content:''; position:absolute; width:0;height:0; border-radius:50%;
      top:50%; left:50%; background:rgba(255,255,255,.3);
      transform:translate(-50%,-50%); transition:width .6s,height .6s;
    }
    .ripple:active::before { width:300px;height:300px; }
    .status-online {
      background:#10b981; box-shadow:0 0 12px rgba(16,185,129,.8);
      animation:pulse-fast;
    }
    .animated-section { opacity:0; }
    .config-list::-webkit-scrollbar { width:6px; }
    .config-list::-webkit-scrollbar-thumb { background:rgba(255,255,255,.3); border-radius:10px;}
  </style>
</head>

<body class="min-h-screen text-gray-200">

  <!-- Welcome Modal -->
  <div id="welcomeModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur flex items-center justify-center p-4 animate-fade-in z-50">
    <div class="bg-white rounded-3xl p-8 max-w-sm w-full animate-slide-up shadow-2xl text-center">
      <div class="w-20 h-20 bg-gradient-to-br from-brand-400 to-brand-600 rounded-full mx-auto mb-4 flex items-center justify-center shadow-lg">
        <span class="text-3xl">🎉</span>
      </div>
      <h2 class="text-xl font-semibold text-gray-800 mb-2">به LIo خوش آمدید!</h2>
      <p class="text-gray-600 mb-6">این دروازه اینترنت آزاد، پرسرعت و امنه. آماده‌ایم شروع کنیم!</p>
      <button onclick="closeWelcome()" class="w-full bg-gradient-to-r from-brand-500 to-brand-700 text-white py-3 rounded-xl font-bold ripple shadow-lg hover:from-brand-600 hover:to-brand-800 transition">
        بزن بریم
      </button>
    </div>
  </div>

  <!-- Header -->
  <header class="py-20 relative overflow-hidden">
    <div class="absolute inset-0 opacity-20 animate-float">
      <div class="absolute top-0 left-0 w-72 h-72 bg-gradient-to-tr from-brand-300/40 to-brand-600/40 rounded-full blur-3xl"></div>
      <div class="absolute bottom-0 right-0 w-80 h-80 bg-gradient-to-br from-brand-200/30 to-brand-500/30 rounded-full blur-3xl" style="animation-delay:-2s"></div>
    </div>
    <div class="container mx-auto px-4 relative z-10 text-center animate-fade-in">
      <!-- Logo + Title -->
      <div class="flex flex-col items-center mb-12 md:flex-row md:justify-center">
        <div class="card-glass w-24 h-24 rounded-full flex items-center justify-center shadow-2xl neon-ring mb-4 md:mb-0 md:mr-6">
          <!-- Inline SVG Logo -->
          <svg width="56" height="56" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="lg1" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0%" stop-color="#22d3ee"/>
                <stop offset="100%" stop-color="#a855f7"/>
              </linearGradient>
              <linearGradient id="lg2" x1="1" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#06b6d4"/>
                <stop offset="100%" stop-color="#f43f5e"/>
              </linearGradient>
            </defs>
            <circle cx="32" cy="32" r="28" fill="none" stroke="url(#lg1)" stroke-width="3"/>
            <path d="M20 20 v24 h10" fill="none" stroke="url(#lg2)" stroke-width="4" stroke-linecap="round"/>
            <circle cx="44" cy="36" r="8" fill="none" stroke="url(#lg1)" stroke-width="4"/>
            <path d="M49 31 q4 5 0 10" fill="none" stroke="url(#lg2)" stroke-width="3" stroke-linecap="round"/>
          </svg>
        </div>
        <div>
          <h1 class="text-4xl md:text-5xl lg:text-6xl font-extrabold text-white">LIo</h1>
          <p class="text-brand-200 mt-1">سرویس VPN حرفه‌ای و رایگان</p>
        </div>
      </div>

      <!-- Stats -->
      <div class="space-y-6">
        <div class="card-glass p-6 rounded-3xl inline-block shadow-2xl animate-slide-up">
          <div class="grid grid-cols-3 gap-6 text-center">
            <div>
              <div class="flex items-center justify-center mb-2">
                <div class="w-3 h-3 status-online rounded-full ml-2"></div>
                <span class="font-semibold text-white">وضعیت</span>
              </div>
              <span class="text-brand-200 font-mono">آپتایم: <strong id="uptime">--</strong>%</span>
            </div>
            <div>
              <div class="text-2xl font-bold text-white" id="activeServers">--</div>
              <span class="text-brand-200">سرور فعال</span>
            </div>
            <div>
              <div class="text-2xl font-bold text-white" id="serverPing">--</div>
              <span class="text-brand-200">پینگ</span>
            </div>
          </div>
        </div>

        <div class="card-glass p-6 rounded-3xl inline-block shadow-2xl max-w-2xl w-full animate-slide-up">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
            <div>
              <i class="fa-solid fa-wifi text-brand-300 text-2xl mb-1"></i>
              <h3 class="text-gray-300 text-sm">آدرس IP شما</h3>
              <p id="user-ip" class="font-mono text-white font-semibold animate-pulse">در حال بارگذاری...</p>
            </div>
            <div>
              <i class="fa-solid fa-location-dot text-emerald-300 text-2xl mb-1"></i>
              <h3 class="text-gray-300 text-sm">موقعیت مکانی</h3>
              <p id="user-location" class="font-mono text-white font-semibold animate-pulse">در حال بارگذاری...</p>
            </div>
            <div>
              <i class="fa-solid fa-building text-fuchsia-300 text-2xl mb-1"></i>
              <h3 class="text-gray-300 text-sm">سرویس‌دهنده</h3>
              <p id="user-isp" class="font-mono text-white font-semibold animate-pulse">در حال بارگذاری...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="space-y-24 pb-16">

    <!-- Quick Actions -->
    <section id="quick" class="container mx-auto px-4">
      <div class="grid md:grid-cols-3 gap-6 max-w-4xl mx-auto">
        <a href="#sublink" class="card-glass p-6 rounded-3xl text-center ripple group">
          <div class="w-16 h-16 bg-gradient-to-br from-emerald-500 to-green-600 rounded-2xl mx-auto mb-4 flex items-center justify-center shadow-lg group-hover:scale-110 transition">
            <i class="fa-solid fa-link text-white text-2xl"></i>
          </div>
          <h3 class="font-bold text-white mb-1">لینک اشتراک</h3>
          <p class="text-gray-300 text-sm">افزودن خودکار همه سرورها</p>
        </a>
        <a href="#tools" class="card-glass p-6 rounded-3xl text-center ripple group">
          <div class="w-16 h-16 bg-gradient-to-br from-cyan-500 to-fuchsia-600 rounded-2xl mx-auto mb-4 flex items-center justify-center shadow-lg group-hover:scale-110 transition">
            <i class="fa-solid fa-toolbox text-white text-2xl"></i>
          </div>
          <h3 class="font-bold text-white mb-1">ابزارهای واقعی</h3>
          <p class="text-gray-300 text-sm">تست پینگ و نشت DNS</p>
        </a>
        <a href="#notifications" class="card-glass p-6 rounded-3xl text-center ripple group">
          <div class="w-16 h-16 bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl mx-auto mb-4 flex items-center justify-center shadow-lg group-hover:scale-110 transition">
            <i class="fa-solid fa-bell text-white text-2xl"></i>
          </div>
          <h3 class="font-bold text-white mb-1">آخرین آپدیت‌ها</h3>
          <p class="text-gray-300 text-sm">اخبار و اطلاعیه‌ها</p>
        </a>
      </div>
    </section>

    <!-- Subscription Link -->
    <section id="sublink" class="animated-section container mx-auto px-4">
      <div class="card-glass p-8 rounded-3xl shadow-2xl text-center max-w-3xl mx-auto">
        <div class="w-20 h-20 bg-gradient-to-br from-emerald-500 to-green-600 rounded-2xl mx-auto mb-4 flex items-center justify-center shadow-lg">
          <i class="fa-solid fa-link text-white text-2xl"></i>
        </div>
        <h2 class="text-2xl font-bold text-white mb-2">لینک اشتراک (Subscription)</h2>
        <p class="text-gray-300 mb-4">این لینک را در کلاینت خود وارد کنید تا همه‌ سرورها افزوده شوند</p>
        <div class="bg-black bg-opacity-20 p-4 rounded-xl mb-4 shadow-inner">
          <code id="subLink" class="block font-mono text-white break-all">https://dev1.irdevs.sbs</code>
        </div>
        <button onclick="copySubLink()" class="btn-3d bg-gradient-to-r from-emerald-500 to-green-500 text-white px-6 py-3 rounded-xl font-semibold ripple shadow-lg hover:from-emerald-600 hover:to-green-600 transition">
          <i class="fa-solid fa-copy ml-2"></i> کپی لینک
        </button>
      </div>
    </section>

    <!-- Notifications / Timeline -->
    <section id="notifications" class="animated-section container mx-auto px-4">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold text-white mb-2">آخرین اخبار و اطلاعیه‌ها</h2>
        <p class="text-gray-300">همراه به‌روز باشید</p>
      </div>
      <div class="timeline-container max-w-3xl mx-auto space-y-6">
        <!-- خبر 1 -->
        <div class="timeline-item relative flex space-x-4 space-x-reverse">
          <div class="flex-shrink-0 z-10">
            <span class="w-10 h-10 bg-cyan-500 rounded-full flex items-center justify-center shadow-md text-white">
              <i class="fa-solid fa-cloud"></i>
            </span>
          </div>
          <div class="card-glass p-4 rounded-2xl w-full">
            <div class="flex justify-between mb-2">
              <h3 class="font-bold text-cyan-300">۸ سرور جدید CDN آلمان</h3>
              <time class="text-xs text-gray-400">امروز</time>
            </div>
            <p class="text-gray-300">۸ سرور کلودفلر افزایش پایداری و سرعت برای شما آماده شد. لینک اشتراک را آپدیت کنید.</p>
          </div>
        </div>
        <!-- خبر 2 -->
        <div class="timeline-item relative flex space-x-4 space-x-reverse">
          <div class="flex-shrink-0 z-10">
            <span class="w-10 h-10 bg-emerald-500 rounded-full flex items-center justify-center shadow-md text-white">
              <i class="fa-solid fa-gamepad"></i>
            </span>
          </div>
          <div class="card-glass p-4 rounded-2xl w-full">
            <div class="flex justify-between mb-2">
              <h3 class="font-bold text-emerald-300">۶ سرور نیم‌بها ویژه گیمرها</h3>
              <span class="bg-yellow-200 text-yellow-800 text-xs px-2 py-0.5 rounded-full">ویژه</span>
            </div>
            <p class="text-gray-300">سرورهای داخلی با ترافیک نیم‌بها برای بازی و استریم آماده است. لذت ببرید!</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Server Configs & QR -->
    <section id="servers" class="animated-section container mx-auto px-4">
      <div class="card-glass p-8 rounded-3xl shadow-2xl max-w-6xl mx-auto grid lg:grid-cols-2 gap-8">
        <!-- کپی کانفیگ -->
        <div>
          <h3 class="text-xl font-bold text-white mb-4 text-center">کپی مستقیم کانفیگ</h3>
          <div id="config-list-container" class="space-y-3 h-64 overflow-y-auto config-list pr-2"></div>
        </div>
        <!-- QR Code -->
        <div>
          <h3 class="text-xl font-bold text-white mb-4 text-center">QR کد کانفیگ</h3>
          <div class="bg-white p-4 rounded-xl mb-4 shadow-inner text-center">
            <div id="qrcode"></div>
          </div>
          <select id="configSelect" onchange="generateQR()" class="w-full bg-gray-700 border border-gray-600 rounded-lg p-3 text-white">
            <option value="cf_de_1">VLESS – LIo 1 🇩🇪</option>
            <option value="cf_de_2">VLESS – LIo 2 🇩🇪</option>
            <option value="cf_de_tr_5">Trojan – LIo 5 🇩🇪</option>
          </select>
        </div>
      </div>
    </section>

    <!-- Tools: Ping & DNS Leak -->
    <section id="tools" class="animated-section container mx-auto px-4">
      <div class="grid lg:grid-cols-2 gap-8 max-w-6xl mx-auto">
        <!-- Live Ping -->
        <div class="card-glass p-8 rounded-2xl shadow-xl text-center">
          <h3 class="text-2xl font-bold text-white mb-4">تست زنده پینگ</h3>
          <div id="ping-list-container" class="h-48 overflow-y-auto config-list pr-2 space-y-2 mb-4"></div>
          <button id="pingTestBtn" onclick="runAllPings()" class="btn-3d bg-gradient-to-r from-teal-500 to-cyan-500 text-white px-6 py-3 rounded-xl shadow-lg hover:from-teal-600 hover:to-cyan-600 transition disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="fa-solid fa-play ml-2"></i> شروع تست
          </button>
        </div>
        <!-- DNS Leak -->
        <div class="card-glass p-8 rounded-2xl shadow-xl text-center">
          <h3 class="text-2xl font-bold text-white mb-4">بررسی نشت DNS</h3>
          <div id="dns-leak-result" class="h-48 flex items-center justify-center text-gray-400 mb-4">
            روی دکمه کلیک کنید
          </div>
          <button id="dnsTestBtn" onclick="checkDNSLeak()" class="btn-3d bg-gradient-to-r from-amber-500 to-red-500 text-white px-6 py-3 rounded-xl shadow-lg hover:from-amber-600 hover:to-red-600 transition disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="fa-solid fa-search ml-2"></i> شروع بررسی
          </button>
        </div>
      </div>
    </section>

    <!-- Download Clients -->
    <section id="download" class="animated-section container mx-auto px-4">
      <div class="text-center mb-6">
        <h2 class="text-3xl font-bold text-white">دانلود کلاینت‌ها</h2>
        <p class="text-gray-300">انتخاب اپلیکیشن مناسب شما</p>
      </div>
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl mx-auto">
        <a href="https://github.com/2dust/v2rayNG/releases" target="_blank" class="card-glass p-6 rounded-2xl text-center hover:scale-105 transition">
          <i class="fa-brands fa-android text-4xl text-green-400 mb-2"></i>
          <h4 class="font-semibold text-white">Android</h4>
          <p class="text-green-300 text-sm">V2RayNG</p>
        </a>
        <a href="https://apps.apple.com/app/streisand/id6450534064" target="_blank" class="card-glass p-6 rounded-2xl text-center hover:scale-105 transition">
          <i class="fa-brands fa-apple text-4xl text-gray-300 mb-2"></i>
          <h4 class="font-semibold text-white">iOS</h4>
          <p class="text-gray-200 text-sm">Streisand</p>
        </a>
        <a href="https://github.com/2dust/v2rayN/releases" target="_blank" class="card-glass p-6 rounded-2xl text-center hover:scale-105 transition">
          <i class="fa-brands fa-windows text-4xl text-blue-400 mb-2"></i>
          <h4 class="font-semibold text-white">Windows</h4>
          <p class="text-blue-300 text-sm">v2rayN</p>
        </a>
        <a href="https://github.com/hiddify/hiddify-next/releases" target="_blank" class="card-glass p-6 rounded-2xl text-center hover:scale-105 transition">
          <i class="fa-brands fa-apple text-4xl text-gray-400 mb-2"></i>
          <h4 class="font-semibold text-white">macOS</h4>
          <p class="text-gray-300 text-sm">Hiddify Next</p>
        </a>
      </div>
    </section>

    <!-- Tutorial Steps -->
    <section id="tutorial" class="animated-section container mx-auto px-4">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold text-white">راهنمای ۴ مرحله‌ای</h2>
        <p class="text-gray-300">سریع وصل شو و لذت ببر</p>
      </div>
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div class="card-glass p-6 rounded-2xl text-center">   
          <div class="w-16 h-16 bg-gradient-to-br from-emerald-400 to-green-500 rounded-full mx-auto mb-3 flex items-center justify-center text-white font-bold text-xl shadow-lg">1</div>
          <h4 class="font-semibold text-white mb-1">کپی لینک</h4>
          <p class="text-gray-300 text-sm">به بخش لینک اشتراک برو و کپی کن</p>
        </div>
        <div class="card-glass p-6 rounded-2xl text-center">   
          <div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full mx-auto mb-3 flex items-center justify-center text-white font-bold text-xl shadow-lg">2</div>
          <h4 class="font-semibold text-white mb-1">نصب کلاینت</h4>
          <p class="text-gray-300 text-sm">اپ را دانلود و نصب کن</p>
        </div>
        <div class="card-glass p-6 rounded-2xl text-center">   
          <div class="w-16 h-16 bg-gradient-to-br from-fuchsia-400 to-violet-500 rounded-full mx-auto mb-3 flex items-center justify-center text-white font-bold text-xl shadow-lg">3</div>
          <h4 class="font-semibold text-white mb-1">افزودن سرورها</h4>
          <p class="text-gray-300 text-sm">لینک را داخل اپ وارد کن</p>
        </div>
        <div class="card-glass p-6 rounded-2xl text-center">   
          <div class="w-16 h-16 bg-gradient-to-br from-pink-400 to-rose-500 rounded-full mx-auto mb-3 flex items-center justify-center text-white font-bold text-xl shadow-lg">4</div>
          <h4 class="font-semibold text-white mb-1">اتصال نهایی</h4>
          <p class="text-gray-300 text-sm">روی سرور بزن و وصل شو</p>
        </div>
      </div>
    </section>

    <!-- FAQ -->
    <section id="faq" class="animated-section container mx-auto px-4">
      <div class="text-center mb-6">
        <h2 class="text-3xl font-bold text-white">سوالات متداول</h2>
      </div>
      <div id="faq-container" class="space-y-4 max-w-3xl mx-auto"></div>
    </section>

    <!-- Troubleshooting -->
    <section id="troubleshooting" class="animated-section container mx-auto px-4">
      <div class="text-center mb-6">
        <h2 class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-yellow-500">عیب‌یابی هوشمند</h2>
      </div>
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto">
        <div class="card-glass p-6 rounded-2xl text-center">
          <i class="fa-solid fa-wifi-slash text-3xl text-red-400 mb-2"></i>
          <h4 class="font-semibold text-white mb-2">وصل نمی‌شود؟</h4>
          <ul class="text-gray-300 text-sm space-y-2">
            <li>لینک اشتراک را آپدیت کن</li>
            <li>اینترنت را چک کن</li>
            <li>سرور دیگری را امتحان کن</li>
          </ul>
        </div>
        <div class="card-glass p-6 rounded-2xl text-center">
          <i class="fa-solid fa-gauge-simple-low text-3xl text-orange-400 mb-2"></i>
          <h4 class="font-semibold text-white mb-2">سرعت پایین است؟</h4>
          <ul class="text-gray-300 text-sm space-y-2">
            <li>تست پینگ اجرا کن</li>
            <li>سرور با پینگ کمتر انتخاب کن</li>
            <li>برنامه‌های پرمصرف را ببند</li>
          </ul>
        </div>
        <div class="card-glass p-6 rounded-2xl text-center">
          <i class="fa-solid fa-triangle-exclamation text-3xl text-blue-400 mb-2"></i>
          <h4 class="font-semibold text-white mb-2">هنوز مشکل داری؟</h4>
          <ul class="text-gray-300 text-sm space-y-2">
            <li>اپ خود را آپدیت کن</li>
            <li>دستگاه را ری‌استارت کن</li>
            <li>با پشتیبانی تماس بگیر</li>
          </ul>
        </div>
      </div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="bg-black/50 pt-12 pb-6 text-gray-400 text-center">
    <div class="max-w-2xl mx-auto space-y-4">
      <div class="flex justify-center space-x-4 space-x-reverse">
        <a href="https://t.me/asrnovin_ir" target="_blank" class="card-glass p-4 rounded-xl shadow-lg hover:scale-105 transition">
          <i class="fa-solid fa-user-astronaut text-2xl text-white"></i>
          <span class="sr-only">Developer</span>
        </a>
        <a href="https://t.me/asrnovin_ir" target="_blank" class="card-glass p-4 rounded-xl shadow-lg hover:scale-105 transition">
          <i class="fa-brands fa-telegram text-2xl text-white"></i>
          <span class="sr-only">Telegram Channel</span>
        </a>
      </div>
      <p>© 1404 LIo – ساخته شده با ❤️ برای مردم ایران</p>
    </div>
  </footer>

  <!-- Scripts: Core & Builders & Tools -->
  <script>
    // --- Data & Configs ---
    const configs = {
      cf_de_1: { name:'VLESS – LIo 1 🇩🇪', config:'vless://…#LIo1' },
      cf_de_2: { name:'VLESS – LIo 2 🇩🇪', config:'vless://…#LIo2' },
      cf_de_tr_5:{ name:'Trojan – LIo 5 🇩🇪', config:'trojan://…#LIo5' }
    };
    const faqData = [
      {q:'این سرویس رایگانه؟', a:'بله … همیشه رایگان می‌مونه.'},
      {q:'چرا سرعت کم میشه؟', a:'شلوغیه سرورها یا اختلال …'},
      {q:'آیا امنه؟', a:'بله، با پروتکل‌های قوی رمزنگاری.'},
      {q:'چطور بهتر بشه؟', a:'سروری نزدیکتر یا بستن برنامه‌ها.'},
      {q:'اگر قطع شد؟', a:'سرور دیگه انتخاب کن.'},
      {q:'روی همه کار می‌کنه؟', a:'بله، اندروید/ iOS/ ویندوز/ macOS.'}
    ];

    // --- Core Functions ---
    document.addEventListener('DOMContentLoaded',()=>{
      if(!sessionStorage.getItem('lioWelcomed')) document.getElementById('welcomeModal').classList.remove('hidden');
      buildFAQ(); buildConfigList(); updateStats(); generateQR();
      setInterval(updateStats,3000);
      getUserInfo();
      // Animate sections
      new IntersectionObserver(entries=>{
        entries.forEach(e=>{ if(e.isIntersecting) e.target.classList.add('animate-slide-up'); });
      },{threshold:0.1}).observe(document.querySelector('#quick'));
      document.querySelectorAll('.animated-section').forEach(sec=> new IntersectionObserver(
        (e)=>e.forEach(v=>{ if(v.isIntersecting) v.target.classList.add('animate-slide-up'); }),
        {threshold:0.1}
      ).observe(sec));
    });

    function closeWelcome(){
      sessionStorage.setItem('lioWelcomed','1');
      document.getElementById('welcomeModal').classList.add('hidden');
    }

    function updateStats(){
      // Uptime
      const start=new Date('2023-01-01'), now=new Date();
      let total=(now-start)/1000, down=2*3600, up=total-down;
      document.getElementById('uptime').textContent=(up/total*100).toFixed(2);
      // Ping
      const ping=45+Math.random()*20-10;
      document.getElementById('serverPing').textContent=Math.round(ping)+' ms';
      document.getElementById('activeServers').textContent=24;
    }

    async function getUserInfo(){
      try{
        const r=await fetch('https://ipapi.co/json/'), d=await r.json();
        document.getElementById('user-ip').textContent=d.ip||'–';
        document.getElementById('user-location').textContent=`${d.city},${d.country_name}`||'–';
        document.getElementById('user-isp').textContent=d.org||'–';
        document.querySelectorAll('.animate-pulse').forEach(el=>el.classList.remove('animate-pulse'));
      }catch{['user-ip','user-location','user-isp'].forEach(id=>document.getElementById(id).textContent='خطا');}
    }

    async function copySubLink(){
      const t=document.getElementById('subLink').textContent.trim();
      try{await navigator.clipboard.writeText(t); alert('کپی شد✅');}
      catch{alert('خطا❌');}
    }

    function buildConfigList(){
      const c=document.getElementById('config-list-container');
      c.innerHTML=''; Object.entries(configs).forEach(([k,v])=>{
        const btn=document.createElement('button');
        btn.className='w-full text-left bg-white/10 hover:bg-white/20 p-3 rounded-lg ripple flex justify-between';
        btn.textContent=v.name; btn.onclick=()=>copyConfig(k);
        c.appendChild(btn);
      });
    }

    function copyConfig(k){
      navigator.clipboard.writeText(configs[k].config)
        .then(_=>alert('کانفیگ کپی شد✅')).catch(_=>alert('خطا❌'));
    }

    function generateQR(){
      const sel=document.getElementById('configSelect').value, data=configs[sel].config;
      const qrEl=document.getElementById('qrcode');
      qrEl.innerHTML=''; const qr=qrcode(0,'M'); qr.addData(data); qr.make();
      qrEl.innerHTML=qr.createSvgTag({cellSize:4,margin:2});
    }

    async function runAllPings(){
      const btn=document.getElementById('pingTestBtn');
      btn.disabled=true; btn.textContent='… در حال تست';
      const list=document.getElementById('ping-list-container'); list.innerHTML='';
      const servers=[{name:'Cloudflare',url:'cloudflare.com'},{name:'LIo',url:'dev1.irdevs.sbs'},{name:'Germany',url:'fk31lndm4w8uj0yp1dr...'}];
      await Promise.all(servers.map(s=>pingOne(s,list)));
      btn.disabled=false; btn.innerHTML='<i class="fa-solid fa-play ml-2"></i> شروع تست';
    }

    async function pingOne({name,url},container){
      const el=document.createElement('div');
      el.className='flex justify-between bg-black/30 p-2 rounded text-sm';
      el.innerHTML=`<span>${name}</span><span class="animate-pulse">…</span>`;
      container.appendChild(el);
      const start=performance.now();
      try{await fetch(`https://${url}/favicon.ico?${Date.now()}`,{mode:'no-cors'});}
      catch{}
      const ms=Math.round(performance.now()-start),
            sp=el.querySelector('span:last-child');
      sp.textContent=`${ms} ms`;
      sp.classList.remove('animate-pulse');
      sp.classList.add(ms<150?'text-green-400':ms<300?'text-yellow-400':'text-red-400');
    }

    async function checkDNSLeak(){
      const btn=document.getElementById('dnsTestBtn'),
            res=document.getElementById('dns-leak-result');
      btn.disabled=true; res.innerHTML='<span>… در حال بررسی</span>';
      try{
        const r=await fetch('https://www.dnsleaktest.com/json.php'),
              data=await r.json();
        let html='<ul class="space-y-1 text-sm">';
        let leak=false;
        data.forEach(s=>{ html+=`<li>${s.ip} (${s.country_name})</li>`; if(s.country_code==='IR') leak=true;});
        html+='</ul>';
        html+= leak
          ?'<p class="text-red-400 mt-2">احتمال نشت DNS!</p>'
          :'<p class="text-green-400 mt-2">اتصال امن است</p>';
        res.innerHTML=html;
      }catch{
        res.innerHTML='<p class="text-red-400">خطا!</p>';
      }
      btn.disabled=false;
    }

    // Build FAQ
    function buildFAQ(){
      const c=document.getElementById('faq-container');
      faqData.forEach(item=>{
        const d=document.createElement('div'); d.className='card-glass p-4 rounded-xl overflow-hidden';
        d.innerHTML=`
          <div class="flex justify-between items-center cursor-pointer" onclick="toggleFAQ(this)">
            <h3 class="font-semibold text-white">${item.q}</h3>
            <i class="fa-solid fa-chevron-down text-gray-300"></i>
          </div>
          <div class="faq-answer text-gray-300 mt-2"><p>${item.a}</p></div>`;
        c.appendChild(d);
      });
    }

    function toggleFAQ(el){
      const ans=el.nextElementSibling, icon=el.querySelector('i');
      if(ans.style.maxHeight){
        ans.style.maxHeight=null; icon.classList.remove('rotate-180');
      } else {
        ans.style.maxHeight=ans.scrollHeight+'px'; icon.classList.add('rotate-180');
      }
    }
  </script>
</body>
</html>
